!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("audiolooper",[],t):"object"==typeof exports?exports.audiolooper=t():e.audiolooper=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=20)}([function(e,t,r){e.exports=!r(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var r=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,r){var n=r(11),o=r(16),u=r(18),i=Object.defineProperty;t.f=r(0)?Object.defineProperty:function(e,t,r){if(n(e),t=u(t,!0),n(r),o)try{return i(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var o=r(8),u=n(o);t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,u.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},function(e,t,r){e.exports={default:r(9),__esModule:!0}},function(e,t,r){r(19);var n=r(2).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(1);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n=r(10);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(1),o=r(4).document,u=n(o)&&n(o.createElement);e.exports=function(e){return u?o.createElement(e):{}}},function(e,t,r){var n=r(4),o=r(2),u=r(12),i=r(15),f="prototype",a=function(e,t,r){var c,s,d,l=e&a.F,p=e&a.G,v=e&a.S,h=e&a.P,b=e&a.B,y=e&a.W,x=p?o:o[t]||(o[t]={}),g=x[f],w=p?n:v?n[t]:(n[t]||{})[f];p&&(r=t);for(c in r)s=!l&&w&&void 0!==w[c],s&&c in x||(d=s?w[c]:r[c],x[c]=p&&"function"!=typeof w[c]?r[c]:b&&s?u(d,n):y&&w[c]==d?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[f]=e[f],t}(d):h&&"function"==typeof d?u(Function.call,d):d,h&&((x.virtual||(x.virtual={}))[c]=d,e&a.R&&g&&!g[c]&&i(g,c,d)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,t,r){var n=r(5),o=r(17);e.exports=r(0)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){e.exports=!r(0)&&!r(3)(function(){return 7!=Object.defineProperty(r(13)("div"),"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(1);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,r){var n=r(14);n(n.S+n.F*!r(0),"Object",{defineProperty:r(5).f})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(6),u=n(o),i=r(7),f=n(i),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AudioContext;(0,u.default)(this,e),this.pausedTracks=new Map,this.bufferNodes=new Map,this.audioCtx=t}return(0,f.default)(e,[{key:"addTrack",value:function(e){var t=this,r=e.id,n=e.audioBuffer,o=e.doProcessing,u=void 0===o||o,i=e.trackAdded,f=void 0===i?function(){}:i,a=0===this.bufferNodes.size,c=void 0;if(!a&&u){for(var s=this.firstTrack.bufferNode.buffer,d=Math.ceil(n.length/s.length),l=this.audioCtx.createBuffer(n.numberOfChannels,s.length*d,s.sampleRate),p=0;p<l.numberOfChannels;p++)for(var v=l.getChannelData(p),h=n.getChannelData(p),b=0;b<h.length;b++)v[b]=h[b];c=l}else c=n;var y=this.audioCtx.createBufferSource();y.buffer=c,y.loop=!0;var x=this.audioCtx.currentTime,g={duration:y.buffer.duration,getCurrentTime:function(){return t.audioCtx.currentTime-x},bufferNode:y,trackAdded:f};this.bufferNodes.set(r,g),a?this.firstTrack=g:x=this.audioCtx.currentTime+(this.firstTrack.duration-this.firstTrack.getCurrentTime()),y.start(x),f(y)}},{key:"pauseTrack",value:function(e){var t=e.id;if(this.exists(t)){var r=this.bufferNodes.get(t);r.bufferNode.stop(),this.pausedTracks.set(t,r),this.removeTrack({id:t})}}},{key:"playTrack",value:function(e){var t=e.id;if(!this.pausedTracks.has(t))throw new Error("You tried to pause an inexistent track!");var r=this.pausedTracks.get(t),n=r.bufferNode.buffer,o=r.trackAdded;this.addTrack({id:t,audioBuffer:n,doProcessing:!1,trackAdded:o})}},{key:"removeTrack",value:function(e){var t=e.id;if(this.exists(t)){var r=this.bufferNodes.get(t);r.bufferNode.stop(),this.bufferNodes.delete(t)}}},{key:"getCurrentTime",value:function(e){var t=e.id;if(this.exists(t)){var r=this.bufferNodes.get(t);return r.getCurrentTime()}}},{key:"exists",value:function(e){if(!this.bufferNodes.has(e))throw new Error("You tried to access an inexistent track!");return!0}}]),e}();t.default=a}])});